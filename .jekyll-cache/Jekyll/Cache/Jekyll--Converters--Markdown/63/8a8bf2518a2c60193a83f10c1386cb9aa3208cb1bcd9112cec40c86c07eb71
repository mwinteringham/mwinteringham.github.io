I"º"<p>Part of my workshop â€˜Understanding and testing RESTful Web serivcesâ€™ relies on attendees testing my demo web service <a href="https://github.com/mwinteringham/restful-booker" target="_blank">restful-booker</a> and when <a href="https://github.com/mwinteringham/restful-booker" target="_blank">restful-booker</a> starts up it generates a group of records for the attendees to use.</p>

<p>I thought I would shared how I achieved this as I find a lot of time I am creating little scripts like the one we shall see in order to quickly create test data. So therefore in this post Iâ€™ll go into how I create randomised data so that you can use this idea to help you create your own randomisation script that can easily be reused for automated checks, exploratory testing or performance testing.</p>

<p>The post assumes you have a basic understanding of JavaScript and Mongo.</p>
<h3>Getting started</h3>
<p>Before we start generating the data we will need the following applications installed and set up:</p>

<ul>
  <li><a title="NodeJS" href="https://nodejs.org/" target="_blank">Node v0.12.4</a></li>
  <li><a href="https://www.mongodb.org/" target="_blank">mongodb.org v3.0.3</a></li>
</ul>

<p>Head to the link, install Mongo and startup the Mongo service and weâ€™ll begin.</p>
<h3>The problem</h3>
<p>Restful-booker uses MongoDB to store the records for each booking. The model for each booking record is as follows:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>{
"_id": "554a49813fbbaece35502fb6",
"firstname": "Sally",
"lastname": "Brown",
"totalprice": 111,
"depositpaid": true,
"additionalneeds": "Breakfast",
"bookingdates": {
"checkin": "2013-02-23T00:00:00.000Z",
"checkout": "2014-10-23T00:00:00.000Z"
}
}
</code></pre></div></div>

<p>The <em>_id</em> field is generated by Mongo but we need to generate the rest of the data in the model and do it in a way that each record we create contains randomised data.</p>
<h3>Building the randomised data</h3>
<p>Firstly, lets start by building the model and outputting the contents using Node.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">additionalneeds</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>Running the script will output the object youâ€™ve just created but we still need to randomise the data within the model so weâ€™ll start by creating a set of first names and then randomly choosing one:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">)</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">from</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Firstly we add in the array of first names we want to select from and then create the <em>randomiseNumber</em> function. The <em>randomiseNumber</em> function allows us to put a minimum and maximum integer and it will use the native Math functions to generate an integer within your desired range. The reason we use this function is so we can easily increase or decrease the amount of entries in the first name array and leave the rest of the code unchanged.</p>

<p>You can read more on how the Math function works <a href="http://stackoverflow.com/questions/1527803/generating-random-numbers-in-javascript-in-a-specific-range">here</a></p>

<p>So with the name array and the <em>randomiseNumber</em> function set in place we can now use them to randomise the <em>firstname</em> parameter.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">from</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">additionalneeds</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>Now in place of static text for firstname we can use the name array and pass it a random integer using <em>randomiseNumber</em>. Since arrays are zero indexed we give it a minimum range of 0 and a maximum of the length of the array minus one to make the maximum zero indexed too. With that in place we can run the script a few times and now see the <em>firstname</em> parameter changing each time.</p>

<p>With that in place we can copy the same practise over to the <em>lastname</em> parameter like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">from</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="mi">111</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">additionalneeds</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>With the <em>firstname</em> and <em>lastname</em> now randomised we can start on the <em>totalprice</em> parameter. Since we want to create a random integer for the total price we can simply reuse <em>randomiseNumber</em> again and give it a large range such as 100 to 1000:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">from</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">additionalneeds</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>Now onto <em>depositpaid</em>. For this we can use a little trick with JavaScript and use Math.random() &gt;= 0.5. Since Math.random() will generate a float between 0 and 1 we have an even chance of getting a true or false and using that little piece of code within an object will actually return us a boolean which will be added to the object. So add it in as shown below and give it a try:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="k">from</span><span class="p">);</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">additionalneeds</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>Youâ€™ll notice now that the boolean for <em>depositpaid</em> will randomly switch now.</p>

<p>Now, in <a href="https://github.com/mwinteringham/restful-booker">restful-booker</a> the additionalneeds feed is optional so rather than randomise itâ€™s content we are going to randomise itâ€™s appearance. We can use the same randomised boolean trick we used for <em>depositpaid</em> like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>Finally we want to create randomised dates within a set range as we will always want the <em>checkin</em> date to be before the <em>checkout</em> date and we can do this by creating the following:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">randomiseDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">latestDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">checkInDate</span> <span class="o">=</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="nx">latestDate</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;</span><span class="p">;</span><span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="nx">checkInDate</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(),</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>The <em>randomiseDate</em> function much like the <em>randomiseNumber</em> function will take two date objects and create a date between the two ranges. So, as shown in the example above, we can create a checkin date between 1st January 2013 by creating two new date objects (one being specifically set to the 1st January 2013) and passing them to <em>randomiseDate</em>.</p>

<p>The date randomisation code was taken from <a href="http://stackoverflow.com/a/9035732">here</a></p>

<p>You may also notice that the <em>checkInDate</em> is created outside of the object and thatâ€™s because we will use the <em>checkInDate</em> and the <em>latestDate</em> with randomiseDate to create the <em>checkout</em> date like so:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">randomiseDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">latestDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">checkInDate</span> <span class="o">=</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="nx">latestDate</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="nx">checkInDate</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="nx">checkInDate</span><span class="p">,</span><span class="nx">latestDate</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
</code></pre></div></div>

<p>So now we have the script in place to create randomised data we now need to get it into Mongo, which we can do in a couple of ways.</p>
<h3>Getting the data into Mongo - Using the Mongo shell</h3>
<p>The Mongo shell is one of the reasons why I love using Mongo.Â  The Mongo shell allows you to execute JavaScript within Mongo itself and it makes it very easy to run something like our script inside Mongo really easily and all it requires is replacing the console.log line of code with the following:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>use test
db.bookings.insert(booking)
</code></pre></div></div>

<p>The <em>use test</em> line allows us to switch to the database we want to use and since Mongo comes with a test database out of the box that seems sensible to use. Then we call Mongoâ€™s library to connect to the db and insert our booking into a collection called bookings.</p>

<p>With those two lines in you can start up your mongo service and then simply call</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>mongo &lt; name_of_file.js
</code></pre></div></div>

<p>Which will result in output similar to this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>MongoDB shell version: 2.6.5
connecting to: test
switched to db test
WriteResult({ "nInserted" : 1 })
bye
</code></pre></div></div>

<p>A quick look in Mongo in the test database will reveal a bookings collection with our record created. So if we want to create more than one record in one go we simply put our randomisation code into a loop with each loop ending with an insert into Mongo like so (Note that use test is kept at the top of the script now because we donâ€™t need to keep calling that each loop.)</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">use</span> <span class="nx">test</span>

<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">randomiseDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">latestDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">checkInDate</span> <span class="o">=</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="nx">latestDate</span><span class="p">)</span>

<span class="k">for</span><span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span> <span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span> <span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="nx">checkInDate</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="nx">checkInDate</span><span class="p">,</span><span class="nx">latestDate</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">bookings</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">booking</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></div>

<p>And there you go, running the script again will produce you 100 randomised records. If you want more details on how to use the Mongo shell you can view them <a href="https://docs.mongodb.org/getting-started/shell/client/">here</a>.</p>

<p>But what if you canâ€™t access the Mongo shell well there is another way we can use our script.</p>
<h3>Getting the data into Mongo - Remotely connecting to Mongo</h3>
<p>Unless you are working with Mongo on a local system it fairly typical that you wonâ€™t have access to the Mongo shell but there is another way in which you can create content via the MongoDB npm package for Node which allows us to remotely connect to Mongo and insert our data.</p>

<p>Before we change anything we will need to install the npm package mongodb. So run the following in the directory of your script:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>npm install mongodb
</code></pre></div></div>

<p>With the mongodb package installed we update our script to the following:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">MongoClient</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">mongodb</span><span class="dl">'</span><span class="p">).</span><span class="nx">MongoClient</span><span class="p">;</span>

<span class="nx">MongoClient</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">mongodb://localhost:27017/test</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">db</span><span class="p">)</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">bookings</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">randomiseDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">latestDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">checkInDate</span> <span class="o">=</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="nx">latestDate</span><span class="p">)</span>

<span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span>
<span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span>
<span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="nx">checkInDate</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="nx">checkInDate</span><span class="p">,</span><span class="nx">latestDate</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">collection</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<p>There are a few new parts to this that Iâ€™ll explain</p>

<ol>
  <li>Firstly we pull in the MongoClient library with the require which we will use to make the connection to Mongo</li>
  <li>With the library in place we make the connection to <em>mongodb://localhost:27017/test</em>.Â  Mongo runs on port 27017 as default but it may be updated so if connect to mongo on a different IP it may be the port is different. Finally the /test indicates which database we want to work with and just like the previous section we will use test.</li>
  <li>Once the connection is open we need to determine which collection within Mongo we want to use so for this example we assign the collection â€˜bookingsâ€™ to the variable collection.</li>
  <li>With the collection now set we can generate our object and then finally call collection.insert to send our object to Mongo where it will be created.</li>
  <li>And to conclude we close the DB down to let the script exit.</li>
</ol>

<p>Give the script a run using:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>node .js
</code></pre></div></div>

<p>Once run you should see your randomised data appear in Mongo. And with that we finish the script by adding the for loop:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">MongoClient</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">mongodb</span><span class="dl">'</span><span class="p">).</span><span class="nx">MongoClient</span><span class="p">;</span>

<span class="nx">MongoClient</span><span class="p">.</span><span class="nx">connect</span><span class="p">(</span><span class="dl">"</span><span class="s2">mongodb://localhost:27017/test</span><span class="dl">"</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">db</span><span class="p">)</span> <span class="p">{</span>
<span class="kd">var</span> <span class="nx">collection</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">collection</span><span class="p">(</span><span class="dl">'</span><span class="s1">bookingshttp</span><span class="dl">'</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">name</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Mark</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Mary</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Sally</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jim</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Eric</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Susan</span><span class="dl">"</span><span class="p">]</span>
<span class="kd">var</span> <span class="nx">surname</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">Jones</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Wilson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Jackson</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Brown</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Smith</span><span class="dl">"</span><span class="p">,</span><span class="dl">"</span><span class="s2">Ericsson</span><span class="dl">"</span><span class="p">]</span>

<span class="kd">var</span> <span class="nx">randomiseNumber</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="k">from</span><span class="p">,</span> <span class="nx">to</span><span class="p">){</span>
<span class="k">return</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">floor</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">to</span> <span class="o">-</span> <span class="k">from</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">+</span> <span class="k">from</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">randomiseDate</span> <span class="o">=</span> <span class="kd">function</span><span class="p">(</span><span class="nx">start</span><span class="p">,</span> <span class="nx">end</span><span class="p">)</span> <span class="p">{</span>
<span class="k">return</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">+</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">*</span> <span class="p">(</span><span class="nx">end</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()</span> <span class="o">-</span> <span class="nx">start</span><span class="p">.</span><span class="nx">getTime</span><span class="p">()));</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">latestDate</span> <span class="o">=</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span>
<span class="kd">var</span> <span class="nx">checkInDate</span> <span class="o">=</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="k">new</span> <span class="nb">Date</span><span class="p">(</span><span class="mi">2013</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span><span class="nx">latestDate</span><span class="p">)</span>

<span class="k">for</span><span class="p">(</span><span class="kd">var</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">){</span> <span class="kd">var</span> <span class="nx">booking</span> <span class="o">=</span> <span class="p">{</span> <span class="dl">"</span><span class="s2">firstname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">name</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">name</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="dl">"</span><span class="s2">lastname</span><span class="dl">"</span><span class="p">:</span> <span class="nx">surname</span><span class="p">[</span><span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nx">surname</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)],</span> <span class="dl">"</span><span class="s2">totalprice</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseNumber</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span><span class="mi">1000</span><span class="p">),</span> <span class="dl">"</span><span class="s2">depositpaid</span><span class="dl">"</span><span class="p">:</span> <span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">bookingdates</span><span class="dl">"</span><span class="p">:</span> <span class="p">{</span>
<span class="dl">"</span><span class="s2">checkin</span><span class="dl">"</span><span class="p">:</span> <span class="nx">checkInDate</span><span class="p">,</span>
<span class="dl">"</span><span class="s2">checkout</span><span class="dl">"</span><span class="p">:</span> <span class="nx">randomiseDate</span><span class="p">(</span><span class="nx">checkInDate</span><span class="p">,</span><span class="nx">latestDate</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">}</span>

<span class="k">if</span><span class="p">(</span><span class="nb">Math</span><span class="p">.</span><span class="nx">random</span><span class="p">()</span> <span class="o">&gt;=</span> <span class="mf">0.5</span><span class="p">){</span>
<span class="nx">booking</span><span class="p">.</span><span class="nx">additionalneeds</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">Breakfast</span><span class="dl">"</span><span class="p">;</span>
<span class="p">}</span>

<span class="nx">collection</span><span class="p">.</span><span class="nx">insert</span><span class="p">(</span><span class="nx">booking</span><span class="p">);</span>
<span class="p">}</span>

<span class="nx">db</span><span class="p">.</span><span class="nx">close</span><span class="p">();</span>
<span class="p">});</span>
</code></pre></div></div>

<p>And once again we have a script that can create multiple randomised bookings but remotely rather than within the shell.</p>
<h3>Wrapping it all up</h3>
<p>So we have looked at using JavaScript to create randomised data in a JSON structure and then looked at how we can use this to populate Mongo with data via the Mongo shell and remotely. But there is more! Not everyone has MongoDB in their technology stack so it maybe that this isnâ€™t entirely relevant, however in the next blog post weâ€™ll look about how you can use the randomisation script weâ€™ve created here to create data over HTTP and learn about the scripts wider application.</p>
:ET